window.__require=function t(e,o,n){function r(a,i){if(!o[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var u="function"==typeof __require&&__require;if(!i&&u)return u(s,!0);if(c)return c(s,!0);throw new Error("Cannot find module '"+a+"'")}}var l=o[a]={exports:{}};e[a][0].call(l.exports,function(t){return r(e[a][1][t]||t)},l,l.exports,t,e,o,n)}return o[a].exports}for(var c="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({Data:[function(t,e,o){"use strict";cc._RF.push(e,"a8e83DXus9IgoRG+hJX3gGV","Data"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./MathVec"),r=function(){function t(){var t=this;this.mergeSuper=function(t,e){for(var o=new Array,n=0,r=t;n<r.length;n++){var c=r[n];o.push(e(c))}return o},this.mergeLeft=function(e){var o,n,r,c=e.length;for(o=0;o<c;o++){for(n=-1,r=o+1;r<c;r++)if(0!==e[r]){n=r;break}-1!==n&&(0===e[o]?(e[o]=e[n],e[n]=0,o-=1):e[o]===e[n]&&(e[o]=2*e[o],t.updateTimes+=e[o],e[n]=0))}return e},this.mergeRight=function(e){var o,n,r;for(o=e.length-1;o>=0;o--){for(n=-1,r=o-1;r>=0;r--)if(0!==e[r]){n=r;break}-1!==n&&(0===e[o]?(e[o]=e[n],e[n]=0,o-=1):e[o]===e[n]&&(e[o]=2*e[o],t.updateTimes+=e[o],e[n]=0))}return e}}return t.getInstance=function(){return this.instance=this.instance?this.instance:new t,this.instance},t.prototype.init=function(t){var e=this;void 0===t&&(t=4),this.map=new Array,this.logInfor="",this.updateTimes=0;for(var o=0;o<t;o++)this.map.push([0,0,0,0]);n.moreFunc(function(){n.visitArrayRand(e.map,function(t,o){n.alterArray(e.map,{raw:t,col:o},2)})},2)},Object.defineProperty(t.prototype,"data",{get:function(){return this.map},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"score",{get:function(){return this.updateTimes},enumerable:!0,configurable:!0}),t.prototype.merge=function(t,e){switch(void 0===e&&(e=this.map),t){case"left":this.map=this.mergeSuper(e,this.mergeLeft),this.logInfor+="mergeLeft--";break;case"right":this.map=this.mergeSuper(e,this.mergeRight),this.logInfor+="mergeRight--";break;case"up":this.map=this.mergeSuper(n.transformArray(e),this.mergeLeft),this.map=n.transformArray(this.map),this.logInfor+="mergeUp--";break;case"down":this.map=this.mergeSuper(n.transformArray(e),this.mergeRight),this.map=n.transformArray(this.map),this.logInfor+="mergeDown--";break;default:throw new Error("Data merge method error")}this.logInfor=this.logInfor.length>50?"":this.logInfor},t.prototype.addRand=function(){var t=this,e=!1,o=n.PointList();if(n.visitArray(this.map,function(n,r){0===t.map[n][r]&&(o.push({x:n,y:r}),e=!0)}),e){var r=n.toInt(Math.random()*o.length);n.alterArray(this.map,{raw:o[r].x,col:o[r].y},2)}return e},t.prototype.log=function(){console.log(this.map,this.logInfor,this.updateTimes)},t}();o.default=r,cc._RF.pop()},{"./MathVec":"MathVec"}],EndScene:[function(t,e,o){"use strict";cc._RF.push(e,"b2955xherpKvIsmJKJ8gLIv","EndScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,c=n.property,a=t("./Data"),i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.score=null,e.title=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.score.string=String(a.default.getInstance().score)},e.prototype.start=function(){this.title.string=Number(this.score.string)>=2048?"Win":"Over"},__decorate([c(cc.Label)],e.prototype,"score",void 0),__decorate([c(cc.Label)],e.prototype,"title",void 0),e=__decorate([r],e)}(cc.Component);o.default=i,cc._RF.pop()},{"./Data":"Data"}],ILayout:[function(t,e,o){"use strict";cc._RF.push(e,"617fcKfdzpB1ZetnigMI+Rl","ILayout"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IMathVec:[function(t,e,o){"use strict";cc._RF.push(e,"47286qu+/9M2LuK7IQ6aBi6","IMathVec"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ITouchFront:[function(t,e,o){"use strict";cc._RF.push(e,"1d2daCpMx1MtKZ5AmY7sl+f","ITouchFront"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],Layout:[function(t,e,o){"use strict";cc._RF.push(e,"ac54eNKPPBPjoUWVTDdAodV","Layout"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Model"),r=t("./MathVec"),c=t("./Data"),a=function(){function t(t){var e=this;return this.color={2:cc.color(237,241,21,255),4:cc.color(241,180,21,255),8:cc.color(171,241,21,255),16:cc.color(149,160,216,255),32:cc.color(187,149,216,255),64:cc.color(216,149,209,255),128:cc.color(28,118,156,255),256:cc.color(16,74,99,255),512:cc.color(168,85,25,255),1024:cc.color(236,122,38,255),2048:cc.color(236,86,33,255)},this.initEdge=function(t){return e.edge=t,e.start=cc.v2(t.width.start,-t.height.start),e},this.background=t,this}return t.prototype.draw=function(t){var e=this;void 0===t&&(t=100),n.default.getInstance().clearNodeList();var o=c.default.getInstance().data;r.visitArray(o,function(r,c){if(0!==o[r][c]){var a=cc.v2(e.start.x+t*c,e.start.y-t*r),i=n.default.getInstance().getBlock();i.setParent(e.background),i.setPosition(a),i.getChildByName("label").getComponent(cc.Label).string=String(o[r][c]),i.color=e.color[String(o[r][c])],n.default.getInstance().saveNode(i)}})},t.prototype.log=function(){cc.log("nodelist:",n.default.getInstance().NodeList.length)},t}();o.default=a,cc._RF.pop()},{"./Data":"Data","./MathVec":"MathVec","./Model":"Model"}],MathVec:[function(t,e,o){"use strict";cc._RF.push(e,"b6f425xFSJKsK9yZt6CDGhx","MathVec"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t,e,o){this.start=t,this.step=e,this.num=o}return t.prototype.randPos=function(){var t=this.start+parseInt(String(Math.random()*this.num))*this.step;return cc.v2(t,t)},t.prototype.randVaule=function(){return this.start+parseInt(String(Math.random()*this.num*this.step))},t}();function r(t){return parseInt(String(t))}o.default=n,o.transformArray=function(t){for(var e=new Array,o=t.length,n=0;n<o;n++){e.push([]);for(var r=0,c=t[n].length;r<c;r++)e[n][r]=t[r][n]}return e},o.visitArray=function(t,e){for(var o=t.length,n=0;n<o;n++)for(var r=t[n].length,c=0;c<r;c++)e(n,c)},o.visitArrayRand=function(t,e){var o=r(Math.random()*t.length);e(o,r(Math.random()*t[o].length))},o.moreFunc=function(t,e){void 0===e&&(e=1);var o=0,n=function(){o>=e||(o++,t(),n())};n()},o.toInt=r,o.randFunc=function(t,e){void 0===e&&(e=1.5);var o=Boolean(r(Math.random()*e));o&&t(o)},o.alterArray=function(t,e,o){t[e.raw].splice(e.col,1,o)},o.computed=function(t,e,o){var n;switch(e){case"+":n=cc.v2(t.x+o.x,t.y+o.y);break;case"-":n=cc.v2(t.x-o.x,t.y-o.y);break;case"*":n=cc.v2(t.x*o.x,t.y*o.y);break;case"/":n=cc.v2(t.x/o.x,t.y/o.y);break;default:throw new Error("computed method unknown")}return n},o.PointList=function(){return new Array},o.judgePos=function(t,e){return t.x===e.x&&t.y===e.y},cc._RF.pop()},{}],Model:[function(t,e,o){"use strict";cc._RF.push(e,"f851aLWv9ZDdIy6K3/l716G","Model"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this._BlockPool=new cc.NodePool,this._nodeList=new Array}return t.getInstance=function(){return this.instance=this.instance?this.instance:new t,this.instance},t.prototype.initPool=function(t,e){for(var o=0;o<e;++o){var n=cc.instantiate(t);this._BlockPool.put(n)}this._prafab=t},Object.defineProperty(t.prototype,"NodeList",{get:function(){return this._nodeList},enumerable:!0,configurable:!0}),t.prototype.getBlock=function(){return this._BlockPool.size()>0?this._BlockPool.get():cc.instantiate(this._prafab)},t.prototype.saveNode=function(t){this._nodeList.push(t)},t.prototype.clearNodeList=function(){for(var t=0,e=this._nodeList;t<e.length;t++){var o=e[t];this._BlockPool.put(o),this._nodeList=[]}},t.prototype.ClearPool=function(){this._nodeList=[],this._BlockPool.clear()},t.prototype.log=function(){console.log(this._BlockPool.size())},t}();o.default=n,cc._RF.pop()},{}],PlayScene:[function(t,e,o){"use strict";cc._RF.push(e,"e9c8bH5ZM1BD4/aKPa9BMFF","PlayScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,c=n.property,a=t("./TouchFront"),i=t("./TouchBlock"),s=t("./Layout"),u=t("./Model"),l=t("./Data"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.background=null,e.layout=null,e.blockPrefab=null,e.score=null,e}return __extends(e,t),e.prototype.onLoad=function(){u.default.getInstance().initPool(this.blockPrefab,16),l.default.getInstance().init()},e.prototype.start=function(){var t=new s.default(this.layout.node);t.initEdge({width:{start:-150,end:150},height:{start:-150,end:150}}).draw(),new i.default(new a.default(this.background.node),t,this.score).load()},e.prototype.onDestroy=function(){u.default.getInstance().ClearPool()},__decorate([c(cc.Sprite)],e.prototype,"background",void 0),__decorate([c(cc.Sprite)],e.prototype,"layout",void 0),__decorate([c(cc.Prefab)],e.prototype,"blockPrefab",void 0),__decorate([c(cc.Label)],e.prototype,"score",void 0),e=__decorate([r],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./Data":"Data","./Layout":"Layout","./Model":"Model","./TouchBlock":"TouchBlock","./TouchFront":"TouchFront"}],SceneGO:[function(t,e,o){"use strict";cc._RF.push(e,"94aadNOQ25Lz7ocijwOXGg9","SceneGO"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,c=n.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.button=null,e.target=null,e}return __extends(e,t),e.prototype.start=function(){var t=this;this.button.node.on("click",function(){cc.director.loadScene(t.target.name)})},__decorate([c({type:cc.Button,displayName:"\u5207\u6362\u6309\u94ae"})],e.prototype,"button",void 0),__decorate([c({type:cc.SceneAsset,displayName:"\u76ee\u6807\u573a\u666f"})],e.prototype,"target",void 0),e=__decorate([r],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],TouchBlock:[function(t,e,o){"use strict";cc._RF.push(e,"4d7b1DBXclKtKexYcerzVy/","TouchBlock"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Data"),r=function(){return function(t,e,o){var r=this;this.load=function(){r.touchFront.submit(r.left,r.right,r.up,r.down).listen()},this.left=function(){n.default.getInstance().merge("left"),r.result=n.default.getInstance().addRand(),r.testResult(),r.layout.draw()},this.right=function(){n.default.getInstance().merge("right"),r.result=n.default.getInstance().addRand(),r.testResult(),r.layout.draw()},this.up=function(){n.default.getInstance().merge("up"),r.result=n.default.getInstance().addRand(),r.testResult(),r.layout.draw()},this.down=function(){n.default.getInstance().merge("down"),r.result=n.default.getInstance().addRand(),r.testResult(),r.layout.draw()},this.testResult=function(){r._score.string=String(n.default.getInstance().score),r._count++,r._count>4&&(!1===r.result?r.gameEnd():r._count=0),Number(r._score.string)>=2048&&r.gameEnd()},this.gameEnd=function(){cc.director.loadScene("EndScene")},this.log=function(){cc.log("result",r.result,"count",r._count)},this.touchFront=t,this.layout=e,this._count=0,this._score=o}}();o.default=r,cc._RF.pop()},{"./Data":"Data"}],TouchFront:[function(t,e,o){"use strict";cc._RF.push(e,"aa7baAl6mJJv4sTM1+od13I","TouchFront"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(t,e,o){void 0===e&&(e=100),void 0===o&&(o=200);var n=this;this.submit=function(t,e,o,r){return n.callbackLeft=t,n.callbackRight=e,n.callbackUp=o,n.callbackDown=r,n},this.listen=function(){var t;n.node.on(cc.Node.EventType.TOUCH_START,function(e){return t=e.getLocation()}),n.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){n._lock++}),n.node.on(cc.Node.EventType.TOUCH_END,function(e){n._lock<n.delta&&n.testPos(t,e.getLocation()),n._lock=0}),n.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){n._lock<n.delta&&n.testPos(t,e.getLocation()),n._lock=0})},this.testPos=function(t,e){Math.abs(e.x-t.x)<n.offset&&Math.abs(e.y-t.y)<n.offset||(Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?e.x-t.x>n.offset?n.callbackRight&&n.callbackRight():e.x-t.x<-n.offset&&n.callbackLeft&&n.callbackLeft():e.y-t.y>n.offset?n.callbackUp&&n.callbackUp():e.y-t.y<-n.offset&&n.callbackDown&&n.callbackDown())},this.node=t,this.offset=e,this._lock=0,this.delta=o}}();o.default=n,cc._RF.pop()},{}]},{},["Data","EndScene","ILayout","IMathVec","ITouchFront","Layout","MathVec","Model","PlayScene","SceneGO","TouchBlock","TouchFront"]);